<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Feedback App</title>
    <link href="style.css" type="text/css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

	<script type="text/javascript">
		//we're using a stacked card approach for our main viewing area
		//this array holds the ids of our cards and the method
		//allows us to easly switch the interface from one to the other
		var contentPanels = ['logonPanel', 'homePanel', 'socialPanel', 'ideaPanel', 'profilePanel', 'reportPanel'];
		//this function toggles which panel is showing, and also clears data from all panels
		function showPanel(panelId) {
			//clearData();
			for (var i = 0; i < contentPanels.length; i++) {
				if (panelId == contentPanels[i]) {
					$("#" + contentPanels[i]).css("visibility", "visible");
				}
				else {
					$("#" + contentPanels[i]).css("visibility", "hidden");
				}
			}
		}



		//this function clears data from all panels
		function clearData() {
			$("#homeBox").empty();
			clearLogon();
		}





		function LogOn(username) {
			//the url of the webservice we will be talking to
			var webMethod = "WebService.asmx/LogOn";
			//the parameters we will pass the service (in json format because curly braces)
			//note we encode the values for transmission over the web.  All the \'s are just
			//because we want to wrap our keynames and values in double quotes so we have to
			//escape the double quotes (because the overall string we're creating is in double quotes!)
			var parameters = "{\"username\":\"" + encodeURI(username) + "\"}";

			//jQuery ajax method
			$.ajax({
				//post is more secure than get, and allows
				//us to send big data if we want.  really just
				//depends on the way the service you're talking to is set up, though
				type: "POST",
				//the url is set to the string we created above
				url: webMethod,
				//same with the data
				data: parameters,
				//these next two key/value pairs say we intend to talk in JSON format
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				//jQuery sends the data and asynchronously waits for a response.  when it
				//gets a response, it calls the function mapped to the success key here
				success: function (msg) {
					//the server response is in the msg object passed in to the function here
					//since our logon web method simply returns a true/false, that value is mapped
					//to a generic property of the server response called d (I assume short for data
					//but honestly I don't know...)
					if (msg.d) {
						//server replied true, so show the accounts panel
						alert("Login successful! Welcome.");
						showPanel('homePanel');
					}
					else {
						//server replied false, so let the user know
						//the logon failed
						alert("logon failed");
					}
				},
				error: function (e) {
					//if something goes wrong in the mechanics of delivering the
					//message to the server or the server processing that message,
					//then this function mapped to the error key is executed rather
					//than the one mapped to the success key.  This is just a garbage
					//alert becaue I'm lazy
					alert("Issue with Connection.");
				}
			});


			function clearLogon() {
				$('#logonId').val("");
			}

			jQuery(function () {
				//when the app loads, show the logon panel to start with!
				showPanel('logonPanel');
			});
		}
	
        //this function grabs accounts and loads our account window
        function LoadPosts() {
            var webMethod = "AccountServices.asmx/GetPosts";
            $.ajax({
                type: "POST",
                url: webMethod,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {
                    if (msg.d.length > 0) {
                        //let's put our accounts that we get from the
                        //server into our accountsArray variable
                        //so we can use them in other functions as well
                        postsArray = msg.d;
                        //this clears out the div that will hold our account info
                        $("#postsBox").empty();
                        for (var i = 0; i < accountsArray.length; i++) {
                            //we grab on to a specific html element in jQuery
                            //by using a  # followed by that element's id.
                            var post;
                            //if they have access to admin-level info (like userid and password) then
                            //create output that has an edit option

                            //if (accountsArray[i].userId != null) {
                            //    acct = "<div class='accountRow' id='acct" + accountsArray[i].id + "'>" +
                            //        "<a class='nameTag' href='mailto:" + accountsArray[i].email + "'>" +
                            //        accountsArray[i].firstName + " " + accountsArray[i].lastName +
                            //        "</a> <a href='#' onclick='LoadAccount(" + accountsArray[i].id + ")' class='optionsTag'>edit</a></div><hr>"
                            //    admin = true;
                            //}

                            ////if not, then they're not an admin so don't include the edit option
                            //else {

                                post = "<div class='postRow' id='post" + postsArray[i].postNumber + "'>" +
                                    "<div>" + postsArray[i].postText + "</div><hr>"

                            //}
                            $("#postsBox").append(
                                //anything we throw at our panel in the form of text
                                //will be added to the contents of that panel.  Here
                                //we're putting together a div that holds info on the post
                                post
                            );
                        }
                    }
                },
                error: function (e) {
                    alert("Getting the Posts isn't working correctly!");
                }
            });
        }





    </script>



</head>
<body>

    <div class="contentContainer">

        <div id="logonPanel" class="contentPanel logonPanel">
            <div class="logonBox">
                <form onsubmit="LogOn($('#logonId').val()); return false;">
                    <h1>Feedback App</h1>
                    <h3>Login Screen</h3>
                    <p>
                        <br>
                        <em>Username</em>:
                        <br>
                        <input id="logonId" type="text">

                        <br>
                        <br>
                        <button type="submit">Login!</button>
                    </p>
                    <br><br>
                </form>

                <div class="feedback-image">
                    <img src="feedback.png" alt="feedback">
                </div>

            </div>
            <footer id="footer">
                Copyright &copy; 2019 Team Nala
            </footer>
        </div>
    </div>






    <div id="homePanel" class="contentPanel" style="visibility:hidden;">

        <div class="homeBox" id="homeBox">


            <header id="header">
                <div class="header-main">

                    <h1>
                        Home!
                    </h1>

                    <button onclick="showPanel('ideaPanel')" class="button">Idea Submission</button>
                    <button onclick=showPanel('profilePanel') class="button">Your Profile</button>
                    <button onclick="showPanel('socialPanel'); LoadPosts()" class="button">Social Page</button>
                    <button onclick=showPanel('reportPanel') class="button">Report Content</button>
                    <button onclick=showPanel('logonPanel') class="button">Exit</button>
                </div>
            </header>


            <div class="survey-image">
                <img src="survey.png" alt="survey">
            </div>


            <footer id="footer">
                Copyright &copy; 2019 Team Nala
            </footer>


        </div>
    </div>





    <div id="socialPanel" class="contentPanel" style="visibility:hidden;">
        <div class="header-main">

            <h1>
                Here are recent posts from your peers!
            </h1>

            <button onclick=showPanel('homePanel') class="button">Home</button>
            <button onclick=showPanel('ideaPanel') class="button">Idea Submission</button>
            <button onclick=showPanel('profilePanel') class="button">Your Profile</button>
            <button onclick=showPanel('reportPanel') class="button">Report Content</button>
            <button onclick=showPanel('logonPanel') class="button">Exit</button>
        </div>

        <div id="postsBox" class="postsBox">


        </div>

        <div class="header-image">
            <img src="media.png" alt="social media">
        </div>


        <footer id="footer">
            Copyright &copy; 2019 Team Nala
        </footer>

    </div>





    <div id="ideaPanel" class="contentPanel" style="visibility:hidden;">
        <div class="header-main">

            <h1>
                Submit any game changing ideas on your mind here!
            </h1>

            <button onclick=showPanel('homePanel') class="button">Home</button>
            <button onclick=showPanel('profilePanel') class="button">Your Profile</button>
            <button onclick="showPanel('socialPanel'); LoadPosts()" class="button">Social Page</button>
            <button onclick=showPanel('reportPanel') class="button">Report Content</button>
            <button onclick=showPanel('logonPanel') class="button">Exit</button>
        </div>

        <div class="header-image">
            <img src="idea.png" alt="lightbulb">
        </div>


        <footer id="footer">
            Copyright &copy; 2019 Team Nala
        </footer>


    </div>






    <div id="profilePanel" class="contentPanel" style="visibility:hidden;">
        <div class="header-main">

            <h1>
                Your Profile!
            </h1>

            <button onclick=showPanel('homePanel') class="button">Home</button>
            <button onclick=showPanel('ideaPanel') class="button">Idea Submission</button>
            <button onclick="showPanel('socialPanel'); LoadPosts()" class="button">Social Page</button>
            <button onclick=showPanel('reportPanel') class="button">Report Content</button>
            <button onclick=showPanel('logonPanel') class="button">Exit</button>
        </div>

        <div class="header-image">
            <img src="profile.png" alt="profile">
        </div>


        <footer id="footer">
            Copyright &copy; 2019 Team Nala
        </footer>


    </div>






    <div id="reportPanel" class="contentPanel" style="visibility:hidden;">
        <div class="header-main">

            <h1>
                Report innappropriate content here.
            </h1>

            <button onclick=showPanel('homePanel') class="button">Home</button>
            <button onclick=showPanel('ideaPanel') class="button">Idea Submission</button>
            <button onclick=showPanel('profilePanel') class="button">Your Profile</button>
            <button onclick="showPanel('socialPanel'); LoadPosts()" class="button">Social Page</button>
            <button onclick=showPanel('logonPanel') class="button">Exit</button>
        </div>

        <div class="header-image">
            <img src="warning.png" alt="warning">
        </div>


        <footer id="footer">
            Copyright &copy; 2019 Team Nala
        </footer>


    </div>







</body>
</html>